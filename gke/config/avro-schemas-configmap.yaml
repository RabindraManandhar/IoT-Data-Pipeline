apiVersion: v1
kind: ConfigMap
metadata:
  name: avro-schemas
  namespace: iot-pipeline
data:
  iot_sensor_reading.avsc: |
    {
      "namespace": "com.iotdatapipeline.avro",
      "type": "record",
      "name": "IoTSensorReading",
      "doc": "Schema for IoT sensor readings - Version 2",
      "fields": [
        {"name": "device_id", "type": "string"},
        {"name": "device_type", "type": "string"},
        {"name": "timestamp", "type": "string"},
        {"name": "value", "type": ["double", "int", "null"]},
        {"name": "unit", "type": "string"},
        {
          "name": "location",
          "type": {
            "type": "record",
            "name": "Location",
            "fields": [
              {"name": "latitude", "type": "double"},
              {"name": "longitude", "type": "double"},
              {"name": "building", "type": ["string", "null"]},
              {"name": "floor", "type": ["int", "null"]},
              {"name": "zone", "type": ["string", "null"], "default": null},
              {"name": "room", "type": ["string", "null"], "default": null}
            ]
          }
        },
        {"name": "battery_level", "type": ["double", "null"]},
        {"name": "signal_strength", "type": ["double", "null"], "default": null},
        {"name": "is_anomaly", "type": "boolean", "default": false},
        {"name": "firmware_version", "type": ["string", "null"], "default": null},
        {"name": "device_metadata", "type": [{"type": "map", "values": "string"}, "null"], "default": null},
        {
          "name": "status",
          "type": {
            "type": "enum",
            "name": "DeviceStatus",
            "symbols": ["ACTIVE", "IDLE", "MAINTENANCE", "ERROR", "UNKNOWN"]
          },
          "default": "ACTIVE"
        },
        {"name": "tags", "type": {"type": "array", "items": "string"}, "default": []},
        {"name": "maintenance_date", "type": ["string", "null"], "default": null}
      ]
    }